 *******************************
 * This is Travel Time Tomography program: Version 1.0            
 * Parallel 2-D Traveltime Inversion based on Fast Sweeping Method and Adjoint-state Technique      
 *                                                           
 * written by  J.W. Huang                         
 * Geological Survey of Canada, Ottawa, Canada         

 * See COPYING file for copying and redistribution conditions.
 *******************************
 
Optimization Method: L-BFGS
Specified Memory Number m=50 (Ignore if L-BFGS is not used)
 *****************************************************************
Inversion of Reflection ONLY
 *****************************************************************
Read input parameters from file RT_SynMod2D_Inv.inp
User Parameters are as follows:

The initial velocity file... ../models/RT_SynMod2D_Inv.vp
The source location file... ../models/RT_SynMod2D.src
The receiver location file... ../models/RT_SynMod2D_Inv_rand2p.rec
The source binary file dimension... 56 x 3
The receiver binary file dimension... 33600 x 7
The reflector geometry file... ../models/RT_SynMod2D.ref
The reflector geometry binary file dimension... 1200 x 3
The size of the model... 160 X 600
Sample Interval... 12.50m x 8.00m
Final Velocity Model Output to ../models/RT_SynMod2D.finalvp
The weighting factor matrix file... ../models/RT_SynMod2D_Inv.wr

L-BFGS quasi-newton method In Use
Line Search with Strong Wolfe Conditions
 
...reading file:
	 ../models/RT_SynMod2D_Inv.vp
 
...reading file:
	 ../models/RT_SynMod2D.src
 
...reading file:
	 ../models/RT_SynMod2D_Inv_rand2p.rec
 
...reading file:
	 ../models/RT_SynMod2D.ref
PE_1 (out of 2) handles 28 shots: 29 ~ 56
PE_0 (out of 2) handles 28 shots: 1 ~ 28
...reading source file:
	../models/RT_SynMod2D.src
 ----------------------------------
| Total Number of Sources: 56
| index	row	column	NumofChn
| 0	41	30	600
| 1	42	40	600
| 2	42	50	600
| 3	39	60	600
| 4	37	70	600
| 5	33	80	600
| 6	29	90	600
| 7	25	100	600
| 8	26	110	600
| 9	26	120	600
| 10	26	130	600
| 11	25	140	600
| 12	24	150	600
| 13	25	160	600
| 14	25	170	600
| 15	25	180	600
| 16	24	190	600
| 17	25	200	600
| 18	26	210	600
| 19	27	220	600
| 20	30	230	600
| ......
| 55	33	580	600
| The End of Source Locations
 ---------------------------------
...reading receiver file:
	../models/RT_SynMod2D_Inv_rand2p.rec
 ----------------------------------
| Total Number of Channels: 33600
| index	row	column		normal_ny	normal_nx	TT	TR1......TRn
| 0	39	1		-0.978	 0.207	 0.159	 0.000...... 0.582
| 1	39	2		-0.997	 0.076	 0.156	 0.000...... 0.578
| 2	39	3		-0.999	 0.044	 0.151	 0.000...... 0.574
| 3	39	4		-0.999	-0.053	 0.141	 0.000...... 0.573
| 4	39	5		-0.996	-0.088	 0.136	 0.000...... 0.573
| 5	39	6		-0.992	 0.127	 0.129	 0.000...... 0.580
| 6	39	7		-0.983	 0.182	 0.125	 0.000...... 0.575
| 7	40	8		-0.996	 0.092	 0.119	 0.000...... 0.572
| 8	40	9		-1.000	 0.010	 0.115	 0.000...... 0.570
| 9	40	10		-0.995	-0.099	 0.113	 0.000...... 0.574
| 10	39	11		-0.999	-0.049	 0.105	 0.000...... 0.577
| 11	39	12		-1.000	 0.023	 0.101	 0.000...... 0.572
| 12	39	13		-0.998	 0.057	 0.095	 0.000...... 0.573
| 13	40	14		-0.987	 0.160	 0.092	 0.000...... 0.570
| 14	40	15		-0.994	 0.105	 0.083	 0.000...... 0.568
| 15	40	16		-1.000	 0.012	 0.077	 0.000...... 0.567
| 16	40	17		-1.000	 0.031	 0.070	 0.000...... 0.570
| 17	40	18		-0.997	 0.071	 0.067	 0.000...... 0.569
| 18	40	19		-1.000	 0.029	 0.063	 0.000...... 0.567
| 19	40	20		-1.000	-0.028	 0.057	 0.000...... 0.567
| 20	40	21		-1.000	 0.012	 0.050	 0.000...... 0.567
| ......
| 33599	38	600		-0.946	 0.323	 0.113	 0.000...... 0.595
| The End of Receiver Locations
 ---------------------------------
...reading reflector geometry file:
	../models/RT_SynMod2D.ref
 ----------------------------------
| Total Number of reflector geometry points: 1200
| Total Number of reflector layers: 2
| index	dz		ref_ny	ref_nx
| 0	640.000	-1.000	 0.000
| 1	640.000	-1.000	 0.000
| 2	640.000	-1.000	 0.000
| 3	640.000	-1.000	 0.000
| 4	640.000	-1.000	 0.000
| 5	640.000	-1.000	 0.000
| 6	640.000	-1.000	 0.000
| 7	640.000	-1.000	 0.000
| 8	640.000	-1.000	 0.000
| 9	640.000	-1.000	 0.000
| 10	640.000	-1.000	 0.000
| 11	640.000	-1.000	 0.000
| 12	640.000	-1.000	 0.000
| 13	640.000	-1.000	 0.000
| 14	640.000	-1.000	 0.000
| 15	640.000	-1.000	 0.000
| 16	640.000	-1.000	 0.000
| 17	640.000	-1.000	 0.000
| 18	640.000	-1.000	 0.000
| 19	640.000	-1.000	 0.000
| 20	640.000	-1.000	 0.000
| ......
| 1199	1280.000	-1.000	 0.000
| The End of Reflector Geometries
 ---------------------------------
 
...reading file:
	 ../models/RT_SynMod2D_Inv.wr
Iterating No. 1: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 29.0876 ms	(T): 20.6191 ms	(R): 20.5169 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT1
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT1
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R1
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R1
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T1
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T1
Secant Method Line Search with Strong Wolfe Condition (alpha1=2.67283e+09)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 2.67283e+09 14.2143 13.6967 -1.49512e-10 4.33022e-10
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 6.86004e+08 14.2143 6.31141 -1.49512e-10 1.3906e-11
Wolfe condition satisfied After 2 Iterations, takes 100.88 seconds, Stepsize=686003996.880063
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_1
--------Interating No. 1 takes   149.3847 seconds---------------

Iterating No. 2: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 28.5038 ms	(T): 20.8995 ms	(R): 19.3824 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT2
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT2
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R2
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R2
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T2
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T2
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 13.6495 5.9821 -0.0300895 -0.010171
Wolfe condition satisfied After 1 Iterations, takes 49.9395 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_2
--------Interating No. 2 takes    99.9113 seconds---------------

Iterating No. 3: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 27.5511 ms	(T): 20.0745 ms	(R): 18.87 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT3
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT3
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R3
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R3
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T3
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T3
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 12.7523 5.91231 -0.00739422 -0.00161718
Wolfe condition satisfied After 1 Iterations, takes 50.5208 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_3
--------Interating No. 3 takes   100.9186 seconds---------------

Iterating No. 4: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 27.2304 ms	(T): 19.7376 ms	(R): 18.7596 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT4
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT4
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R4
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R4
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T4
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T4
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 12.4571 5.88527 -0.00240519 -0.00124666
Wolfe condition satisfied After 1 Iterations, takes 53.1906 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_4
--------Interating No. 4 takes   104.1596 seconds---------------

Iterating No. 5: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 27.0725 ms	(T): 19.5603 ms	(R): 18.7167 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT5
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT5
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R5
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R5
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T5
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T5
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 12.313 5.86359 -0.00306268 -0.000798143
Wolfe condition satisfied After 1 Iterations, takes 55.089 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_5
--------Interating No. 5 takes   108.4862 seconds---------------

Iterating No. 6: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 26.927 ms	(T): 19.3917 ms	(R): 18.6822 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT6
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT6
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R6
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R6
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T6
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T6
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 12.1811 5.86202 -0.00193069 -0.00030497
Wolfe condition satisfied After 1 Iterations, takes 53.4442 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_6
--------Interating No. 6 takes   109.0009 seconds---------------

Iterating No. 7: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 26.877 ms	(T): 19.3247 ms	(R): 18.6797 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT7
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT7
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R7
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R7
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T7
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T7
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 12.1359 5.88188 -0.00176213 0.000345823
Wolfe condition satisfied After 1 Iterations, takes 56.9862 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_7
--------Interating No. 7 takes   111.1144 seconds---------------

Iterating No. 8: (nux,nuy)=(60.000000,20.000000)
Average Time Residual (TR): 26.9503 ms	(T): 19.396 ms	(R): 18.7113 ms
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_RT8
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_RT8
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_R8
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_R8
 
...writing file:
	 ../models/RT_SynMod2D_Inv_bf_regu_T8
 
...writing file:
	 ../models/RT_SynMod2D_Inv_af_regu_T8
Secant Method Line Search with Strong Wolfe Condition (alpha1=1)...
(alpha0,alpha1,phi0,phi1,dphi0,dphi1)=(0 1 12.2021 5.87264 -0.00121354 -0.000256937
Wolfe condition satisfied After 1 Iterations, takes 56.8914 seconds, Stepsize=1.000000
...Updating velocity now...
 
...writing file:
	 ../models/RT_SynMod2D_Inv_8
--------Interating No. 8 takes   114.1883 seconds---------------

 
...writing file:
	 ../models/RT_SynMod2D.finalvp
Total Elapse Time:   897.3809 seconds (  0.2493 hours) 
=================================================================
||		This is a 2D Inversion of Reflection Time ONLY!		   ||
=================================================================
